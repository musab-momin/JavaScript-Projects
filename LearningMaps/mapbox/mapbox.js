mapboxgl.accessToken =
  "pk.eyJ1IjoibXVzYWItbW9taW4iLCJhIjoiY2t5em01b3gxMHhnaTJucXZ1ZzJxbHlpNiJ9.xrVG6rwZ0kJyT8ciaAMVog";

let map = null,
  draw = null; //draw variable is for polygon
const infoBox = document.querySelector(".info");
const allMarkers = [];
let isPloylineActive = false;

//GeoJson Data
const dummyGeoJson = {
  type: "FeatureCollection",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [19.06463271362298, 72.86394596099854],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.86806583404541, 19.068283205579633],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.86355972290039, 19.070554582223995],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.86149978637695, 19.05984639127821],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.85725116729736, 19.070919621995678],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.89909362792969, 19.05968414064215],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.88896560668945, 19.034533373579897],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.86613464355469, 19.043782808432972],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.8946304321289, 19.08158654022563],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.84055709838867, 19.043620542087073],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.91831970214844, 19.05108462980014],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.91471481323242, 19.074935006415263],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.894287109375, 19.09813309948727],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.89497375488281, 19.05076011122854],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.92243957519531, 19.043782808432972],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.9246711730957, 19.0648760822543],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.8338623046875, 18.95370063230706],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.80914306640625, 18.971233956586723],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.82356262207031, 19.004996642802364],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.83866882324219, 18.993959594805983],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.84484863281249, 19.041997869903696],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.8668212890625, 19.01927879438547],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.82974243164061, 19.10948762415022],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.84347534179688, 19.10754118956142],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.8338623046875, 19.10948762415022],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.916259765625, 19.039401561418543],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.90458679199219, 19.098457525292385],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.96638488769531, 19.186029192399957],
      },
    },
  ],
};

const bankGeoJson = {
  type: "FeatureCollection",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [19.06463271362298, 72.86394596099854],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.86806583404541, 19.068283205579633],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.86355972290039, 19.070554582223995],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.86149978637695, 19.05984639127821],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.85725116729736, 19.070919621995678],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.89909362792969, 19.05968414064215],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.88896560668945, 19.034533373579897],
      },
    },
  ],
  properties: {
    class: "red",
    name: "Bank",
  },
};

const schoolGeoJson = {
  type: "FeatureCollection",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.86613464355469, 19.043782808432972],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.8946304321289, 19.08158654022563],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.84055709838867, 19.043620542087073],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.91831970214844, 19.05108462980014],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.91471481323242, 19.074935006415263],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.894287109375, 19.09813309948727],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.89497375488281, 19.05076011122854],
      },
    },
  ],
  properties: {
    class: "green",
    name: "School",
  },
};

const societiesGeoJson = {
  type: "FeatureCollection",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.92243957519531, 19.043782808432972],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.9246711730957, 19.0648760822543],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.8338623046875, 18.95370063230706],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.80914306640625, 18.971233956586723],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.82356262207031, 19.004996642802364],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.83866882324219, 18.993959594805983],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.84484863281249, 19.041997869903696],
      },
    },
  ],
  properties: {
    class: "blue",
    name: "Society",
  },
};

const groceryStoresGeoJson = {
  type: "FeatureCollection",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.92243957519531, 19.043782808432972],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.9246711730957, 19.0648760822543],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.8338623046875, 18.95370063230706],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.80914306640625, 18.971233956586723],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.82356262207031, 19.004996642802364],
      },
    },
  ],
  properties: {
    class: "purple",
    name: "Grocery_Stores",
  },
};

const hospitalGeoJson = {
  type: "FeatureCollection",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.84484863281249, 19.041997869903696],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.8668212890625, 19.01927879438547],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.82974243164061, 19.10948762415022],
      },
    },
  ],
  properties: {
    class: "orange",
    name: "Hospitals",
  },
};

const officeGeoJson = {
  type: "FeatureCollection",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.84347534179688, 19.10754118956142],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.8338623046875, 19.10948762415022],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.916259765625, 19.039401561418543],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.90458679199219, 19.098457525292385],
      },
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [72.96638488769531, 19.186029192399957],
      },
    },
  ],
  properties: {
    class: "pink",
    name: "Offices",
  },
};

// Add the control to the map.
const addControlles = () => {
  // Add the control to the map.
  map.addControl(
    new MapboxGeocoder({
      accessToken: mapboxgl.accessToken,
      mapboxgl: mapboxgl,
    })
  );
};

//initialise map
const init = (addControlles) => {
  map = new mapboxgl.Map({
    container: "map", // container ID
    style: "mapbox://styles/mapbox/dark-v10", // style URL 'mapbox://styles/mapbox/dark-v10', "mapbox://styles/mapbox/streets-v11"
    center: [72.8295, 19.0596], // starting position [lng, lat]
    zoom: 11, // starting zoom
  });
  //adding grid to searched location
  var bbox = [-95, 30, -85, 40];
  var cellSide = 50;
  var options = { units: "miles" };

  var squareGrid = turf.squareGrid(bbox, cellSide, options);
  map.on("load", () => {
    // Add a data source containing GeoJSON data.

    map.addSource("maine", {
      type: "geojson",
      data: {
        type: "Feature",
        geometry: {
          type: "LineString",
          // These coordinates outline Maine.
          coordinates: [
            [432.8085422515869, 18.892644321876922],
            [432.80897140502924, 18.89361879975625],
            [432.8082847595215, 18.894430860322643],
            [432.80665397644043, 18.895811354244756],
            [432.8051090240478, 18.89792267586807],
            [432.8045082092285, 18.89987156449635],
            [432.8033924102783, 18.90287605666507],
            [432.8034782409668, 18.90531209179186],
            [432.8036499023437, 18.907666892030633],
            [432.80433654785156, 18.90953446864917],
            [432.80545234680176, 18.911239629089017],
            [432.8067398071289, 18.9127823783159],
            [432.8077697753906, 18.914000328178407],
            [432.80845642089844, 18.91456870174502],
            [432.8093147277832, 18.913594345876575],
            [432.810001373291, 18.91261998433065],
            [432.8123188018799, 18.91132082677156],
            [432.81394958496094, 18.912132801428715],
            [432.8148078918457, 18.91261998433065],
            [432.8158378601074, 18.914812289824994],
            [432.8163528442383, 18.916111420258215],
            [432.8159236907959, 18.917410540597004],
            [432.8168678283691, 18.918141291351336],
            [432.8185844421387, 18.91757292992957],
            [432.81978607177734, 18.91757292992957],
            [432.82193183898926, 18.91635500609067],
            [432.822961807251, 18.91724815110672],
            [432.8225326538086, 18.918141291351336],
            [432.8233051300049, 18.91846606843906],
            [432.8234767913818, 18.919278008397875],
            [432.8248500823974, 18.920089944412993],
            [432.82562255859375, 18.91960278327717],
            [432.82562255859375, 18.920252331142763],
            [432.8251075744629, 18.92057710412903],
            [432.8251075744629, 18.92211976719616],
            [432.8240776062012, 18.922444536553876],
            [432.8228759765625, 18.92276930528053],
            [432.8218460083008, 18.923824799283608],
            [432.82012939453125, 18.923824799283608],
            [432.819185256958, 18.92488028662047],
            [432.81815528869623, 18.925773386083154],
            [432.8188419342041, 18.92642290996703],
            [432.8194427490234, 18.927275406233058],
            [432.8203010559082, 18.92812789814959],
            [432.82111644744873, 18.929183358305547],
            [432.8216314315796, 18.929832868933534],
            [432.82210350036615, 18.930766536037247],
            [432.8227472305297, 18.93178138566616],
            [432.8230047225952, 18.932613557761197],
            [432.823326587677, 18.93334424203614],
            [432.8234553337097, 18.933973439822665],
            [432.8236699104309, 18.934744711295227],
            [432.8237771987915, 18.935556572155416],
            [432.82386302948, 18.936672874394112],
            [432.8238844871521, 18.937870353954523],
            [432.82384157180786, 18.939351969321795],
            [432.8235197067261, 18.941249635554765],
            [432.82317638397217, 18.942294864963095],
            [432.8228330612182, 18.943319792300077],
            [432.82210350036615, 18.9448825406818],
            [432.82154560089106, 18.945826271255402],
            [432.82084822654724, 18.946871472007405],
            [432.8183591365814, 18.949976592913938],
            [432.81667470932007, 18.951691487863858],
            [432.8166103363037, 18.951590015280484],
            [432.8142929077148, 18.952970037127013],
            [432.81034469604487, 18.954593577626767],
            [432.80811309814453, 18.955324165697053],
            [432.8067398071289, 18.953457100935868],
            [432.8051948547363, 18.95240179421961],
            [432.8039073944092, 18.951021767673176],
            [432.80253410339355, 18.949722908732664],
            [432.8001308441162, 18.948667578399416],
            [432.79832839965815, 18.946962799917507],
            [432.79635429382324, 18.944852097671227],
            [432.7949810028076, 18.941523628362617],
            [432.7942085266113, 18.939575225292177],
            [432.7924919128418, 18.93933167330969],
            [432.7918910980224, 18.93981877691942],
            [432.7928352355957, 18.941036529726667],
            [432.7928352355957, 18.942335456264438],
            [432.79326438903803, 18.94363437269587],
            [432.79232025146484, 18.945339185174014],
            [432.7920627593994, 18.94712516052318],
            [432.79154777526855, 18.94891111676097],
            [432.79266357421875, 18.951346480828594],
            [432.793607711792, 18.95240179421961],
            [432.79575347900385, 18.954837107339035],
            [432.79626846313477, 18.95605475056775],
            [432.7980709075928, 18.957840611225677],
            [432.7987575531006, 18.95881470898014],
            [432.79995918273926, 18.95970762692407],
            [432.7998733520508, 18.96141227517836],
            [432.80141830444336, 18.963035733506526],
            [432.80219078063965, 18.965065034189685],
            [432.8035640716553, 18.965714405192006],
            [432.80287742614746, 18.968393033841075],
            [432.80184745788574, 18.96912356145736],
            [432.802448272705, 18.97180213532529],
            [432.80373573303217, 18.97172096705266],
            [432.8051090240478, 18.974967667123238],
            [432.8064823150635, 18.97513000046634],
            [432.80665397644043, 18.97699682254525],
            [432.80613899230957, 18.977564981635126],
            [432.8111171722412, 18.978376634116863],
            [432.81506538391113, 18.983002977753756],
            [432.8132629394531, 18.987629192893266],
            [432.81206130981445, 18.988116155431946],
            [432.81137466430664, 18.987304550409647],
            [432.81128883361816, 18.988521956459653],
            [432.81249046325684, 18.990550946762966],
            [432.8126621246338, 18.991930646045283],
            [432.81532287597656, 18.993229176101],
            [432.81249046325684, 18.993716122260434],
            [432.81214714050293, 18.995501579324294],
            [432.81171798706055, 18.998098573590262],
            [432.81137466430664, 19.001020143697577],
            [432.8130912780762, 19.00386050989949],
            [432.81532287597656, 19.00954109681601],
            [432.81643867492676, 19.012219020499256],
            [432.8167819976806, 19.014734606492876],
            [432.8177261352539, 19.01587066511115],
            [432.8184127807617, 19.016519837978986],
            [432.81695365905756, 19.017087862158856],
            [432.8160095214844, 19.017899321906103],
            [432.81609535217285, 19.020739399826393],
            [432.81609535217285, 19.022686853780744],
            [432.81506538391113, 19.02593255965676],
            [432.81721115112305, 19.023822858048653],
            [432.81815528869623, 19.021550841747317],
            [432.8188419342041, 19.01830505029428],
            [432.82012939453125, 19.017331300498938],
            [432.8218460083008, 19.01716900831182],
            [432.8258800506592, 19.017980467662962],
            [432.8273391723632, 19.019035358897455],
            [432.8302574157715, 19.021469697733504],
            [432.83360481262207, 19.024228571976604],
            [432.83523559570307, 19.026338268433545],
            [432.8371238708496, 19.02998960284281],
            [432.83806800842285, 19.034127684817932],
            [432.8385829925537, 19.037292030878394],
            [432.8381538391113, 19.040943124478616],
            [432.83841133117676, 19.043539408854627],
            [432.8372097015381, 19.045729992210426],
            [432.83592224121094, 19.047596021893877],
            [432.8381538391113, 19.047596021893877],
            [432.8415012359619, 19.047596021893877],
            [432.8422737121582, 19.048569594268972],
            [432.8422737121582, 19.05043559202223],
            [432.8438186645508, 19.05076011122854],
            [432.8455352783203, 19.050922370593696],
            [432.8478527069092, 19.05084124093095],
            [432.8515434265137, 19.05173366503917],
            [432.84948348999023, 19.049137508850016],
            [432.85205841064453, 19.04646018023745],
            [432.85600662231445, 19.04905637831458],
            [432.85780906677246, 19.05108462980014],
            [432.8625297546387, 19.05327511355604],
            [432.86587715148926, 19.053761883796376],
            [432.86991119384766, 19.050111072181206],
            [432.87746429443354, 19.044918668412617],
            [432.87952423095703, 19.031936948379204],
            [432.87403106689453, 19.022849140580178],
            [432.8664779663086, 19.015059195461667],
            [432.86476135253906, 19.008567295694345],
            [432.86338806152344, 19.002399756194887],
            [432.8614997863769, 19.002075142518798],
            [432.86004066467285, 19.001263605557746],
            [432.8599548339844, 18.998910125987525],
            [432.85969734191895, 18.997530484557373],
            [432.8606414794922, 18.99606967528269],
            [432.85969734191895, 18.995014638388092],
            [432.85780906677246, 18.995014638388092],
            [432.85712242126465, 18.99379727981519],
            [432.8551483154297, 18.992498754191008],
            [432.8569507598877, 18.991200218437786],
            [432.85823822021484, 18.9882784759617],
            [432.8590965270996, 18.985924812793375],
            [432.8599548339844, 18.983489953820023],
            [432.8609848022461, 18.981785531359048],
            [432.8590106964111, 18.980162255657838],
            [432.8573799133301, 18.978457799147563],
            [432.8540325164795, 18.979350611875443],
            [432.85102844238276, 18.979918762938336],
            [432.8498268127441, 18.979918762938336],
            [432.8495693206787, 18.97910711796963],
            [432.85051345825195, 18.978538964138725],
            [432.8524017333984, 18.978376634116863],
            [432.8542900085449, 18.978051973598657],
            [432.85523414611816, 18.97772731244779],
            [432.85557746887207, 18.97699682254525],
            [432.8543758392334, 18.97699682254525],
            [432.8528308868408, 18.977240319535298],
            [432.85085678100586, 18.977646147061236],
            [432.84965515136713, 18.97797080837025],
            [432.849440574646, 18.977280902332367],
            [432.8492259979248, 18.976469244512735],
            [432.850341796875, 18.976144580277797],
            [432.85120010375977, 18.9759822479231],
            [432.8515863418579, 18.97622574639584],
            [432.8524017333984, 18.976144580277797],
            [432.8545904159546, 18.975860498553303],
            [432.855749130249, 18.975495249910125],
            [432.8554058074951, 18.974845917012118],
            [432.853946685791, 18.975089417145394],
            [432.8515863418579, 18.975373500184503],
            [432.8508996963501, 18.97557641634447],
            [432.8506851196289, 18.975332916922852],
            [432.8499126434326, 18.975332916922852],
            [432.8493547439575, 18.975414083436252],
            [432.84892559051514, 18.97500825047384],
            [432.8499126434326, 18.974440082665964],
            [432.85162925720215, 18.974155998035574],
            [432.85330295562744, 18.97383132929355],
            [432.8540325164795, 18.97358782732193],
            [432.853775024414, 18.972857319272276],
            [432.8524446487427, 18.97228914413098],
            [432.8513717651367, 18.97261381587748],
            [432.850341796875, 18.973222573697356],
            [432.84965515136713, 18.973344324994503],
            [432.8491401672363, 18.97350665991898],
            [432.84871101379395, 18.972979070836246],
            [432.84965515136713, 18.972573231943745],
            [432.8498697280884, 18.97200505583393],
            [432.8498697280884, 18.970909282152192],
            [432.850341796875, 18.970300515882784],
            [432.8505563735962, 18.969935255053898],
            [432.8505563735962, 18.96920473099487],
            [432.8489685058594, 18.96940765466576],
            [432.8481960296631, 18.969529408749707],
            [432.8475522994995, 18.968514788666106],
            [432.8475522994995, 18.968108938903473],
            [432.84802436828613, 18.968393033841075],
            [432.84871101379395, 18.968677128294495],
            [432.8506851196289, 18.9687582980494],
            [432.85167217254633, 18.968636543402212],
            [432.85205841064453, 18.968230693936018],
            [432.85107135772705, 18.968108938903473],
            [432.84909725189203, 18.968393033841075],
            [432.84828186035156, 18.967824843481715],
            [432.8491401672363, 18.96790601365162],
            [432.8502988815307, 18.96774367327228],
            [432.85004138946533, 18.96701313960892],
            [432.84995555877686, 18.96644494454641],
            [432.84871101379395, 18.966566700794257],
            [432.8478527069092, 18.96644494454641],
            [432.8478527069092, 18.96563323395504],
            [432.8475522994995, 18.965024448418056],
            [432.84725189208984, 18.963522767922893],
            [432.84725189208984, 18.962995147240942],
            [432.8482389450073, 18.962792215764885],
            [432.8491830825805, 18.96262987040622],
            [432.84862518310547, 18.96181814124214],
            [432.84845352172846, 18.960722300602985],
            [432.84828186035156, 18.96051936636108],
            [432.8481101989746, 18.959464104322546],
            [432.8479814529419, 18.95881470898014],
            [432.84690856933594, 18.959058232529838],
            [432.8459644317627, 18.9591394069674],
            [432.84626483917236, 18.95869294707193],
            [432.8460502624512, 18.95804354872699],
            [432.84746646881104, 18.95824648598139],
            [432.8478956222534, 18.95808413619762],
            [432.8475522994995, 18.957231797240325],
            [432.84725189208984, 18.95581122263303],
            [432.84690856933594, 18.95495887206185],
            [432.84643650054926, 18.953944163322795],
            [432.84643650054926, 18.952888859687302],
            [432.8459644317627, 18.951874138358427],
            [432.8462219238281, 18.951346480828594],
            [432.8457927703857, 18.950453518130693],
            [432.8460931777954, 18.950128803237597],
            [432.8463935852051, 18.949438781991766],
            [432.84647941589355, 18.948464629493294],
            [432.8460502624512, 18.946191584883643],
            [432.84544944763184, 18.944365008747084],
            [432.84502029418945, 18.94266018631978],
            [432.8443765640259, 18.940590021395284],
            [432.84441947937006, 18.939047528881108],
            [432.844033241272, 18.937545614583332],
            [432.8436470031738, 18.935962501105557],
            [432.8433895111084, 18.935434793277985],
            [432.84308910369873, 18.936774356045806],
            [432.8428316116333, 18.937992131055903],
            [432.8433895111084, 18.938682199619574],
            [432.8436470031738, 18.940590021395284],
            [432.8440761566162, 18.941685994258798],
            [432.84446239471436, 18.943269053471045],
            [432.8448486328125, 18.945014460330086],
            [432.84536361694336, 18.94692220974141],
            [432.8454923629761, 18.94822109048018],
            [432.84459114074707, 18.948545809085367],
            [432.84424781799316, 18.948018141031103],
            [432.84399032592773, 18.94594804255366],
            [432.8434753417969, 18.944892688350755],
            [432.8432607650757, 18.94266018631978],
            [432.8426170349121, 18.941645402799562],
            [432.8415870666504, 18.941604811330453],
            [432.8420162200928, 18.94314728021845],
            [432.84253120422363, 18.9449332790204],
            [432.8423595428467, 18.945745090340562],
            [432.8415012359619, 18.945745090340562],
            [432.84128665924067, 18.94452737187972],
            [432.8409004211426, 18.94302550687703],
            [432.8406000137329, 18.941604811330453],
            [432.84021377563477, 18.940102920035542],
            [432.83995628356934, 18.93896634466984],
            [432.8403425216675, 18.93847923857335],
            [432.8417587280273, 18.938276277280433],
            [432.8417158126831, 18.936896133946437],
            [432.842059135437, 18.935434793277985],
            [432.84240245819086, 18.933932846488617],
            [432.8423595428467, 18.93312097773569],
            [432.8406000137329, 18.933567506038145],
            [432.83965587615967, 18.93303979064335],
            [432.83965587615967, 18.93210613624528],
            [432.83965587615967, 18.930928912392183],
            [432.83729553222656, 18.92914276380747],
            [432.83570766448975, 18.92962989713354],
            [432.83502101898193, 18.928939791169068],
            [432.8343343734741, 18.928168492894276],
            [432.8344202041626, 18.927518975795895],
            [432.8346347808838, 18.926869456172636],
            [432.8360939025879, 18.92703183631516],
            [432.83669471740717, 18.92747838089343],
            [432.83806800842285, 18.925367432373655],
            [432.8388833999634, 18.923581224336093],
            [432.83991336822504, 18.921592015643892],
            [432.8399991989136, 18.920658297276994],
            [432.8385400772094, 18.920455314333125],
            [432.837553024292, 18.92106426242524],
            [432.83695220947266, 18.921754400914384],
            [432.8360939025879, 18.92280990132698],
            [432.83527851104736, 18.923662416024715],
            [432.83467769622797, 18.924027778135336],
            [432.8340768814087, 18.923337649033588],
            [432.83381938934326, 18.92240394041868],
            [432.8316307067871, 18.918344277105113],
            [432.8297424316406, 18.91623321321881],
            [432.8308153152466, 18.91456870174502],
            [432.8294420242309, 18.913391354356023],
            [432.8278970718384, 18.91217340005808],
            [432.8274250030517, 18.91144262322147],
            [432.82639503479004, 18.912498188738237],
            [432.8266096115112, 18.912944772143444],
            [432.8260517120361, 18.91326955932542],
            [432.82527923583984, 18.91326955932542],
            [432.8250217437744, 18.91245759018771],
            [432.8248071670532, 18.911808012038954],
            [432.8254508972168, 18.91103663471019],
            [432.82652378082275, 18.910184055628548],
            [432.8252363204956, 18.907788691141366],
            [432.82386302948, 18.908803680281785],
            [432.8224468231201, 18.910265253823567],
            [432.8225326538086, 18.91091483796462],
            [432.82210350036615, 18.91091483796462],
            [432.8214168548584, 18.9103058529063],
            [432.82047271728516, 18.9099810599685],
            [432.82000064849854, 18.909372071510134],
            [432.8203868865967, 18.908357085818793],
            [432.8194427490234, 18.90734209396845],
            [432.8187561035156, 18.907788691141366],
            [432.81854152679443, 18.907301494166326],
            [432.8180265426636, 18.90770749174407],
            [432.81699657440186, 18.906570696043214],
            [432.81699657440186, 18.906083495520818],
            [432.81789779663086, 18.90539329235189],
            [432.8174257278442, 18.90454068450596],
            [432.8172969818115, 18.903606870927337],
            [432.8172969818115, 18.902632451201637],
            [432.81712532043457, 18.901333216073475],
            [432.8167390823364, 18.900277580103946],
            [432.8158378601074, 18.899181335702714],
            [432.8150224685669, 18.89824749221548],
            [432.81463623046875, 18.89751665454736],
            [432.81394958496094, 18.895933161985404],
            [432.81304836273193, 18.895039903162274],
            [432.811803817749, 18.894877491955047],
            [432.8101730346679, 18.89475568344621],
            [432.8097009658813, 18.894024830531848],
            [432.8094005584717, 18.892928545177654],
            [432.80845642089844, 18.892684925235134],
          ],
        },
      },
    });

    //fill the source area with color
    // map.addLayer({
    //   id: "maine",
    //   type: "fill",
    //   source: "maine", // reference the data source
    //   layout: {},
    //   sprite: "mapbox://sprites/mapbox/bright-v8",
    //   paint: {
    //     "fill-color": "#0000FF", // blue color fill
    //     "fill-opacity": 0.5,
    //   },
    // });
    // Add a black outline around the polygon.
    map.addLayer({
      id: "outline",
      type: "line",
      source: "maine",
      layout: {},
      paint: {
        "line-color": "#fff",
        "line-width": 1,
      },
    });
  });
  //adding a polygone to map
  addControlles();
};

//for option select search
const handleOptionSearch = (eve) => {
  if (eve.target.value === "none") {
    infoBox.classList.remove("active");
    return;
  } else {
    for (const feature of dummyGeoJson.features) {
      const el = document.createElement("div");
      el.className =
        eve.target.value === "Banks"
          ? "red"
          : eve.target.value === "Schools"
          ? "green"
          : "blue";

      el.style.cursor = "pointer";
      new mapboxgl.Marker(el)
        .setLngLat(feature.geometry.coordinates)
        .addTo(map);
    }
  }
  infoBox.classList.add("active");

  //adding a single marker to map
  //new mapboxgl.Marker().setLngLat([72.8834, 19.0621]).addTo(map);
};

const addMarkers = (fileName) => {
  for (const feature of fileName.features) {
    const el = document.createElement("div");
    el.className = "marker";
    el.style.background = fileName.properties.class;
    el.style.cursor = "pointer";
    const marker = new mapboxgl.Marker(el)
      .setLngLat(feature.geometry.coordinates)
      .addTo(map);
    allMarkers.push({ marker: marker, markerName: fileName.properties.name });
  }
  infoBox.classList.add("active");
};

const removeMarkers = (markersName) => {
  allMarkers.forEach((obj) => {
    if (obj.markerName === markersName) obj.marker.remove();
    console.log(obj.markerName, ":", markersName);
  });
};

//drop down of filter container
const handleDropDown = (eve) => {
  const dropDownMenu = document.querySelector(".filters_dropdown");
  dropDownMenu.classList.toggle("remove");
};

const handleDropDownSearch = (eve) => {
  switch (eve.target.value) {
    case "Banks":
      if (eve.target.checked) addMarkers(bankGeoJson);
      else removeMarkers("Bank");
      break;
    case "Schools":
      if (eve.target.checked) addMarkers(schoolGeoJson);
      else removeMarkers("School");
      break;
    case "Societies":
      if (eve.target.checked) addMarkers(societiesGeoJson);
      else removeMarkers("Society");
      break;
    case "Grocery_Stores":
      if (eve.target.checked) addMarkers(groceryStoresGeoJson);
      else removeMarkers("Grocery_Stores");
      break;
    case "Hospitals":
      if (eve.target.checked) addMarkers(hospitalGeoJson);
      else removeMarkers("Hospitals");
      break;
    case "Offices":
      if (eve.target.checked) addMarkers(officeGeoJson);
      else removeMarkers("Offices");
      break;
  }
};

const drawOnMap = () => {
  const draw = new MapboxDraw({
    displayControlsDefault: true,
    // Select which mapbox-gl-draw control buttons to add to the map.
    controls: {
      polygon: true,
      trash: true,
      lineString: true,
      combine: true,
      unCombine: true,
    },
  });
  map.addControl(draw);
};

const handlePopulation = (eve) => {
  map.addSource("maharashtra-provinces", {
    type: "geojson",
    data: "maharashtra_population.geojson",
  });
  map.addLayer({
    id: "maharashtra-provinces",
    type: "fill",
    source: "maharashtra-provinces",
    layout: {},
    paint: {
      "fill-color": [
        "let",
        "density",
        ["/", ["get", "population"], ["get", "sq-km"]],
        [
          "interpolate",
          ["linear"],
          ["zoom"],
          8,
          [
            "interpolate",
            ["linear"],
            ["var", "density"],
            274,
            ["to-color", "#FA706B"], 
            1551,
            ["to-color", "#FA1508"],
          ],
          10,
          [
            "interpolate",
            ["linear"],
            ["var", "density"],
            274,
            ["to-color", "#FA1508"],
            1551,
            ["to-color", "#FA706B"],
          ],
        ],
      ],
      "fill-opacity": 0.7,
    },
  });
};

window.onload = () => {
  init(addControlles);
  const options = document.getElementById("places-select");
  options.addEventListener("change", handleOptionSearch);

  const dropdownBtn = document.querySelector(".filters_drop-btn");
  dropdownBtn.addEventListener("click", handleDropDown);

  const dropDownList = document.querySelectorAll(".filters__checkbox");
  dropDownList.forEach((obj) => {
    obj.addEventListener("change", handleDropDownSearch);
  });

  drawOnMap();

  const populationBtn = document.querySelector(".draw__population");
  populationBtn.addEventListener("click", handlePopulation);
};

// map.loadImage(
//   "hnayl1.jpg",
//   (err, image) => {
//     // Throw an error if something goes wrong.
//     if (err) throw err;

//     // Add the image to the map style.
//     map.addImage("pattern", image);

//     // Create a new layer and style it using `fill-pattern`.
//     map.addLayer({
//       id: "pattern-layer",
//       type: "fill",
//       source: "maine",
//       paint: {
//         "fill-pattern": "pattern",
//       },
//     });
//   }
// );
